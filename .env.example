# Server Configuration
PORT=5114
NODE_ENV=development
FRONTEND_URL=http://100.83.153.43:3112

# Database
DATABASE_URL=postgres://postgres:postgres@localhost:5544/ai_trader

# Redis
REDIS_URL=redis://localhost:6491

# JWT
JWT_SECRET=replace_with_secure_secret_key
# Control plane auth token (required for any mutating action)
CONTROL_PLANE_TOKEN=replace_with_long_random_secret

# Coinbase API (Required for Market Data & Execution)
COINBASE_API_KEY=your_coinbase_api_key
COINBASE_API_SECRET=your_coinbase_api_secret
COINBASE_PASSPHRASE=your_coinbase_passphrase
COINBASE_SANDBOX=true
# Coinbase market data feed (Advanced Trade WS default)
COINBASE_WS_URL=wss://advanced-trade-ws.coinbase.com

# Trading Safety Latches
# Keep false for dry-run validation even when UI mode is LIVE.
LIVE_ORDER_POSTING_ENABLED=false
# Legacy alias still respected by backend executor.
LIVE_TRADING_ENABLED=false
# Local path for persisted strategy trade dataset used by validation harness.
STRATEGY_TRADE_LOG_PATH=logs/strategy_trades.csv
# If true, reset validation dataset whenever simulation bankroll/PnL is reset.
RESET_VALIDATION_TRADES_ON_SIM_RESET=true

# Paper Simulation Cost Model (basis points per side)
SIM_FEE_BPS_PER_SIDE=10
SIM_SLIPPAGE_BPS_PER_SIDE=15

# LLM Providers (Required for Intelligence Layer)
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...

# Polymarket (Optional for Arbitrage)
POLYMARKET_API_KEY=...
POLYMARKET_JIGSTACK_API_KEY=...
POLYMARKET_CLOB_HOST=https://clob.polymarket.com
POLY_CHAIN_ID=137
POLY_SIGNATURE_TYPE=1
# Reuse same keys for Rust scanner + backend preflight signer.
PRIVATE_KEY=0x...
PROXY_WALLET_ADDRESS=0x...
POLY_PREFLIGHT_MIN_INTERVAL_MS=1200
POLY_PREFLIGHT_RETRY_ON_ERROR=false
# Backend live-post safety ceilings (USD notional)
POLY_MAX_ORDER_NOTIONAL_USD=500
POLY_MAX_SIGNAL_NOTIONAL_USD=2000
POLY_EXECUTION_MIN_INTERVAL_MS=2500
# Prefer non-resting order types for latency/arbitrage workflows.
POLY_LIVE_ORDER_TYPE=FOK
# Settlement/redeem worker (mainnet defaults from Polymarket docs)
POLY_AUTO_REDEEM_ENABLED=false
POLY_SETTLEMENT_POLL_MS=30000
POLY_REDEEM_RETRY_COOLDOWN_MS=60000
POLY_MIN_REDEEMABLE_SHARES=0.01
POLY_SETTLEMENT_STALE_MS=3600000
POLY_RPC_URL=https://polygon-rpc.com
POLY_CONDITIONAL_TOKENS_ADDRESS=0x4D97DCd97eC945f40cF65F87097ACe5EA0476045
POLY_COLLATERAL_TOKEN_ADDRESS=0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174
# Optional: reset paper bankroll to default on backend boot.
SIM_RESET_ON_BOOT=false
# Optional: strategy variant tag for research comparisons.
STRATEGY_VARIANT=baseline
# Live execution intelligence gate
INTELLIGENCE_GATE_ENABLED=true
INTELLIGENCE_GATE_MAX_STALENESS_MS=3000
INTELLIGENCE_GATE_MIN_MARGIN=0
INTELLIGENCE_GATE_CONFIRMATION_WINDOW_MS=5000
INTELLIGENCE_GATE_REQUIRE_PEER_CONFIRMATION=true
INTELLIGENCE_GATE_STRONG_MARGIN=0.01

# Concentration + utilization controls (paper ledger)
SIM_STRATEGY_CONCENTRATION_CAP_PCT=0.35
SIM_FAMILY_CONCENTRATION_CAP_PCT=0.60
SIM_GLOBAL_UTILIZATION_CAP_PCT=0.90

# Phase 2/3 model controls (advisory + paper gating)
MODEL_PROBABILITY_GATE_ENABLED=true
MODEL_PROBABILITY_GATE_ENFORCE_PAPER=true
MODEL_PROBABILITY_GATE_ENFORCE_LIVE=false
MODEL_PROBABILITY_GATE_MIN_PROB=0.55
MODEL_PROBABILITY_GATE_REQUIRE_MODEL=false
MODEL_PROBABILITY_GATE_DISABLE_ON_DRIFT=true
MODEL_PROBABILITY_GATE_DRIFT_DISABLE_MS=900000
MODEL_PROBABILITY_GATE_MAX_STALENESS_MS=5000
MODEL_PREDICTION_TRACE_MAX=100000

# In-process training cadence (no Python dependency in backend container)
MODEL_TRAINER_ENABLED=true
MODEL_TRAINER_INTERVAL_MS=120000
MODEL_TRAINER_MIN_LABELED_ROWS=80
MODEL_TRAINER_MIN_NEW_LABELS=8
MODEL_TRAINER_SPLITS=5
MODEL_TRAINER_PURGE_ROWS=24
MODEL_TRAINER_EMBARGO_ROWS=24
